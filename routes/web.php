<?php

/*
|--------------------------------------------------------------------------
| Web Routes
|--------------------------------------------------------------------------
|
| Here is where you can register web routes for your application. These
| routes are loaded by the RouteServiceProvider within a group which
| contains the "web" middleware group. Now create something great!
|
*/

Route::redirect('/', '/home');

Auth::routes();

Route::get('/home', 'HomeController@index')->name('home');


Route::post('/transfer', function(\Illuminate\Http\Request $request) {

    $request->validate([
        'email' => 'required|email|exists:users,email',
        'amount' => 'required|integer|min:1|max:'.$request->user()->balance
    ]);


    \DB::transaction(function() use ($request) {
        $reciever = \App\User::query()->where('email')->firstOrFail();
    });


    return back()->with('status', 'Transfer Successful');

})->name('transfer');